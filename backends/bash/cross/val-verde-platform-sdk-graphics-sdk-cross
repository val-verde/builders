#!/bin/bash

set -e

# Source package build helper functions
source /usr/libexec/${VAL_VERDE_GH_TEAM}-platform-sdk-builder-api

# spirv headers build
package-invoke-builder spirv-headers-cross

# spirv tools build
package-invoke-builder spirv-tools-cross

# spirv cross build
package-invoke-builder spirv-cross-cross

# spirv llvm translator build
package-invoke-builder spirv-llvm-translator-cross

if [ "${HOST_OS}" = "android" ]; then
    # khr headers build
    package-invoke-builder khr-headers-cross

    # opengl headers build
    package-invoke-builder opengl-headers-cross
fi

if [ "${HOST_OS}" = "android" ] ||
   [ "${HOST_OS}" = "mingw32" ]; then
    # egl headers build
    package-invoke-builder egl-headers-cross

    # opengl-es headers build
    package-invoke-builder opengl-es-headers-cross
fi

# glslang build
package-invoke-builder glslang-cross

if [ "${HOST_OS}" = "macos" ]; then
    # moltenvk build
    package-invoke-builder moltenvk-cross
else
    # vulkan tools build
    package-invoke-builder vulkan-tools-cross
fi

# vulkan validation layers build
package-invoke-builder vulkan-validation-layers-cross

if [ "${HOST_OS}" = "gnu" ] ||
   [ "${HOST_OS}" = "macos" ] ||
   [ "${HOST_OS}" = "musl" ]; then
    # libclc build
    package-invoke-builder libclc-cross

    # mesa build
    package-invoke-builder mesa-cross
fi

# libepoxy build
package-invoke-builder libepoxy-cross

if [ "${HOST_OS}" = "gnu" ] ||
   [ "${HOST_OS}" = "macos" ] ||
   [ "${HOST_OS}" = "musl" ]; then
    # xorg-xserver build
    package-invoke-builder xorg-xserver-cross
fi

if [ "${HOST_OS}" = "gnu" ] ||
   [ "${HOST_OS}" = "musl" ]; then
    # mesa glu build
    package-invoke-builder mesa-glu-cross

    # freeglut build
    package-invoke-builder freeglut-cross

    # mesa demos build
    package-invoke-builder mesa-demos-cross
fi

# sdl build
DXSDK_DIR=${SYSROOT} \
package-invoke-builder sdl-cross

# sdl-image build
package-invoke-builder sdl-image-cross

# sdl-mixer build
package-invoke-builder sdl-mixer-cross

# sdl-net build
package-invoke-builder sdl-net-cross

# sdl-ttf build
package-invoke-builder sdl-ttf-cross

# filament build
package-invoke-builder filament-cross
